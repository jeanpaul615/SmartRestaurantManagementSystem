#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "üé£ Husky: Ejecutando verificaciones antes del commit..."
echo ""

# ========================================
# üîß BACKEND
# ========================================
echo "üì¶ Verificando Backend..."
cd backend || exit 1

# Lint
echo "  ‚Üí Ejecutando ESLint..."
npm run lint || {
  echo "‚ùå Error: Backend lint fall√≥"
  exit 1
}

echo "  ‚Üí Formateando c√≥digo..."
npm run format || {
  echo "‚ùå Error: Backend format fall√≥"
  exit 1
}

cd ..

# ========================================
# üé® FRONTEND
# ========================================
echo ""
echo "üñºÔ∏è  Verificando Frontend..."
cd frontend || exit 1

# Lint
echo "  ‚Üí Ejecutando ESLint..."
npm run lint || {
  echo "‚ùå Error: Frontend lint fall√≥"
  exit 1
}

# Format (si existe el script)
if grep -q '"format"' package.json 2>/dev/null; then
  echo "  ‚Üí Formateando c√≥digo..."
  npm run format || {
    echo "‚ùå Error: Frontend format fall√≥"
    exit 1
  }
fi

cd ..

# ========================================
# ‚úÖ TODO LISTO
# ========================================
echo ""
echo "‚úÖ Todas las verificaciones pasaron! Haciendo commit..."